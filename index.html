<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Phiếu Xuất Kho</title>
    <link href="form.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>

    <!-- Minimal CSS for Google Sheets -->
    <style>
        /* Only add spinner animation */
        .spinner {
            display: inline-block;
            animation: spin 1s linear infinite;
            margin-right: 5px;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <!-- Simple Google Sheets status - hidden by default -->
    <div id="sheets-status"
        style="display: none; padding: 5px 10px; margin-bottom: 10px; background: #f0f0f0; border-radius: 4px; font-size: 14px;">
        <span id="status-text">Google Sheets: Chưa cấu hình</span>
        <button id="sheets-config-btn"
            style="margin-left: 10px; padding: 2px 8px; font-size: 12px; background: #666; color: white; border: none; border-radius: 3px; cursor: pointer;">
            Cấu hình
        </button>
    </div>

    <div class="container">
        <form method="post" action="" name="PXK">
            <div class="header">
                <div class="co">
                    <div class="formName">
                        <div class="nameSection"></div>
                        <div class="formNumber">
                            <label>Số:</label>
                            <input type="text" disabled>
                        </div>
                        <div class="formNumber">
                            <input type="text" class="number" name="Số PXK" id="pxk-number">
                        </div>
                    </div>
                </div>
                <div class="customer">
                    <div class="left">
                        <p>Tên, đơn vị và địa chỉ khách hàng:</p>
                        <div class="inputArea">
                            <textarea class="name" name="Tên khách" id="customer-name" maxlength="90"></textarea>
                            <textarea class="address" name="Địa chỉ" id="customer-address" maxlength="90"></textarea>
                        </div>
                    </div>

                    <div class="right">
                        <div class="detail">
                            <label>Ngày lập phiếu:</label>
                            <input type="text" class="date" name="Ngày lập phiếu" id="invoice-date">
                        </div>
                        <div class="detail">
                            <label>MST khách hàng:</label>
                            <input type="text" name="MST khách" id="customer-tax">
                        </div>
                        <div class="detail">
                            <label>Số hóa đơn/ngày:</label>
                            <div>
                                <input type="text" class="sm-input" name="Số hóa đơn" id="invoice-number">
                                <input type="text" class="sm-input" name="Ngày" id="invoice-date-2">
                            </div>
                        </div>
                        <div class="detail">
                            <label>Kho xuất hàng:</label>
                            <div>
                                <input type="text" class="sm-input" name="Kho" id="warehouse">
                                <input type="text" class="sm-input" name="Đợt" id="batch">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sttHead">STT</th>
                                <th class="prodNameHead">Tên hàng hóa, dịch vụ</th>
                                <th class="codeHead">Mã hàng</th>
                                <th class="unityHead">Đơn vị tính</th>
                                <th class="quantityHead">Số lượng</th>
                            </tr>
                        </thead>

                        <tbody id="table-body">
                            <!-- Input rows will be added here -->
                        </tbody>
                    </table>

                    <button id="add-row-btn" class="add-row-btn" type="button" aria-label="Thêm dòng">＋</button>
                </div>

                <div class="transport">
                    <div class="transfer">
                        <label>Thông tin giao hàng:</label>
                        <textarea name="TTGH" id="delivery-info" maxlength="150"></textarea>
                    </div>
                    <div class="truck">
                        <div class="truckNumber">
                            <label>Xe vận chuyển số:</label>
                            <input type="text" name="Số xe" id="truck-number">
                        </div>
                        <div class="driver">
                            <label>Tên lái xe:</label>
                            <input type="text" name="Tài xế" id="driver-name">
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                <button id="print-button" type="button">Lưu & In hóa đơn</button>
            </div>

        </form>

    </div>

    <script src="form.js"></script>
</body>

</html>